First refactor

Second bugfix

Feature implemented
