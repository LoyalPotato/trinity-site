First refactor

Refactor 2
